/**
 * This is the squared theme.
 *
 * The squared theme makes uses a custom version of squared blocks.
 *
 * @package theme_squared
 * @copyright 2018 onwards Onlinecampus Virtuelle PH
 * www.virtuelle-ph.at, David Bogner www.edulabs.org
 * @author G J Barnard - {@link http://moodle.org/user/profile.php?id=442195}
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["jquery","core/log"],function(a,b){"use strict";return b.debug("Squared Category Course Search AMD initialised"),{init:function(c){a(document).ready(function(a){b.debug("Squared Category Course Search AMD init"),b.debug("Squared Category Course Search Site URL: "+c.siteurl),b.debug("Squared Category Course Search AJAX URL: "+c.ajaxurl);var d,e=c.catid,f=c.sort,g=!1,h=function(d,g,h,i,k,l){i=void 0!==i?i:e,k=void 0!==k&&k,h=void 0!==h&&h,l=void 0!==l?l:c.ajaxurl,g=void 0!==g?g:f,a.ajax({url:l,data:{sqcategorysearch:d,categoryid:i,searchsort:g},dataType:"html"}).done(function(c){!0===k&&(e=i),!0===h&&(f=g),a("#sqccs").html(c),j(),b.debug("Squared Select Category Course Search done: "+c)}).fail(function(){a("#sq-category-search").val("Select category course search call failed")})},i=function(c){c.preventDefault();var d=c.target.getAttribute("href");null===d&&(d=c.target.parentElement.getAttribute("href")),b.debug("Squared Category Course Search Page Link AJAX URL: "+d),null!==d&&h(a("#sq-category-search").val(),f,!1,e,!1,d)},j=function(){a("#sqccs .pagination li.page-item:not(.active) .page-link").click(function(a){i(a)}),a("#sqccs .paging a").click(function(a){i(a)})};a("#sq-category-search").prop("disabled",!1),a("#sq-category-search").on("change textInput input",function(){var b=a(this).val().length;b>2?(window.clearTimeout(d),d=window.setTimeout(function(a){h(a.val()),g=!0},500,a(this))):0===b&&!0===g&&(h(""),g=!1)}),a("#sq-category-select").prop("disabled",!1),a("#sq-category-select").on("change",function(){var d=a("option:selected",this),g=d.val();if(1==d.data("differenttheme"))b.debug("Squared Select Category Course Redirect: "+g),window.location.replace(c.siteurl+"?categoryid="+g);else{var i=a("#sq-category-search").val();b.debug("Squared Select Category Course Search: "+g+" - "+i);var j=a("body");j.hasClass("category-"+e)&&j.removeClass("category-"+e),"0"!==g&&j.addClass("category-"+g),h(i,f,!1,g,!0)}window.history.pushState(c.categorystr+" - "+g,c.categorystr+" - "+g,c.siteurl+"?categoryid="+g)}),a("#sq-category-sort").prop("disabled",!1),a("#sq-category-sort").on("change",function(){var c=a("option:selected",this).val(),d=a("#sq-category-search").val();b.debug("Squared Select Category Sort Course Search: "+c+" - "+d),h(d,c,!0)}),j()})}}});